generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

// Enum për rolet
enum Role {
  ADMIN
  USER
}


enum Status{
  NEW_POST
  SUBSCRIBE
}

model User {
  id                    Int                    @id @default(autoincrement())
  name                  String
  avatar                String?
  email                 String                 @unique
  password              String
  role                  Role                   @default(USER)
  posts                 Post[]                 // One-to-many relationship: A user has many posts
  subscriptions         Subscription[]         // One-to-many relationship: A user has many subscriptions as a subscriber
  subscribedToAdmin     Subscription[]         @relation("AdminSubscriptions") // Admins that the user has subscribed to
  sentNotifications     Notification[]         @relation("SentNotifications") // Notifications sent by the user
  receivedNotifications Notification[]         @relation("ReceivedNotifications") // Notifications received by the user
}

model Post {
  id       Int    @id @default(autoincrement())
  image    String
  title    String
  authorId Int
  author   User   @relation(fields: [authorId], references: [id]) // Many-to-one: Një post ka një autor
}

// Model për Subskribimet
model Subscription {
  id       Int    @id @default(autoincrement())
  userId   Int
  adminId  Int
  user     User   @relation(fields: [userId], references: [id]) // Përdoruesi që bën subskribimin (subscriber)
  admin    User   @relation("AdminSubscriptions", fields: [adminId], references: [id]) // Admini që është subskribuar
}

model Notification {
  id         Int       @id @default(autoincrement()) // Identifikuesi i njoftimit
  status     Status    
  senderId   Int      
  receiverId Int      

  sender     User      @relation("SentNotifications", fields: [senderId], references: [id]) // Marrëdhënia me përdoruesin që dërgon njoftimin
  receiver   User      @relation("ReceivedNotifications", fields: [receiverId], references: [id]) // Marrëdhënia me përdoruesin që merr njoftimin
}

